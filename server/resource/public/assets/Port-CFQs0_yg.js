import{p as y}from"./index-B4JhxhO9.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{o as q,a as r,c as u,d as t,w as l,e as n,r as d,m as T,b as a,j as _,F as G,B as H,h as D,t as p,s as m,q as J,E as K}from"./index-JfatmDp6.js";const O={class:"port-page"},Q={class:"scan-form"},W={key:0,class:"scan-results"},X={class:"card-header"},Y={key:0,class:"port-detail"},Z={class:"detail-row"},ee={class:"value"},te={class:"detail-row"},le={key:0,class:"detail-row"},ae={class:"value"},oe={key:1,class:"detail-row"},se={class:"value"},ne={key:1,class:"connections"},re={__name:"Port",setup(de){const f=d(!1),b=d(!1),h=d(!1),v=d({startPort:1,endPort:1024}),g=d([]),U=d([]),k=d(!1),B=d(0),c=d(null),P=d([]),E=async()=>{b.value=!0,h.value=!1;try{const s=await y.scan(v.value);g.value=s.data?.ports||[],h.value=!0,K.success(`扫描完成，发现 ${g.value.length} 个开放端口`)}catch(s){console.error(s)}b.value=!1},R=async()=>{f.value=!0;try{const s=await y.listen();U.value=s.data?.ports||[]}catch(s){console.error(s)}f.value=!1},F=async s=>{B.value=s;try{const[e,w]=await Promise.all([y.check(s),y.connections(s)]);c.value=e.data||{},P.value=w.data?.connections||[],k.value=!0}catch(e){console.error(e)}};return q(()=>{R()}),(s,e)=>{const w=n("el-input-number"),I=n("Search"),V=n("el-icon"),C=n("el-button"),x=n("el-tag"),z=n("el-empty"),N=n("el-card"),A=n("Refresh"),i=n("el-table-column"),L=n("View"),S=n("el-table"),M=n("el-dialog"),$=T("loading");return r(),u("div",O,[t(N,{class:"scan-card"},{header:l(()=>[...e[3]||(e[3]=[a("span",null,"端口扫描",-1)])]),default:l(()=>[a("div",Q,[t(w,{modelValue:v.value.startPort,"onUpdate:modelValue":e[0]||(e[0]=o=>v.value.startPort=o),min:1,max:65535,placeholder:"起始端口"},null,8,["modelValue"]),e[5]||(e[5]=a("span",{class:"separator"},"-",-1)),t(w,{modelValue:v.value.endPort,"onUpdate:modelValue":e[1]||(e[1]=o=>v.value.endPort=o),min:1,max:65535,placeholder:"结束端口"},null,8,["modelValue"]),t(C,{type:"primary",onClick:E,loading:b.value},{default:l(()=>[t(V,null,{default:l(()=>[t(I)]),_:1}),e[4]||(e[4]=_(" 扫描 ",-1))]),_:1},8,["loading"])]),g.value.length?(r(),u("div",W,[(r(!0),u(G,null,H(g.value,o=>(r(),D(x,{key:o.port,class:"port-tag"},{default:l(()=>[_(p(o.port)+"/"+p(o.protocol),1)]),_:2},1024))),128))])):h.value?(r(),D(z,{key:1,description:"未发现开放端口"})):m("",!0)]),_:1}),t(N,null,{header:l(()=>[a("div",X,[e[7]||(e[7]=a("span",null,"监听端口",-1)),t(C,{onClick:R,loading:f.value},{default:l(()=>[t(V,null,{default:l(()=>[t(A)]),_:1}),e[6]||(e[6]=_(" 刷新 ",-1))]),_:1},8,["loading"])])]),default:l(()=>[J((r(),D(S,{data:U.value,style:{width:"100%"}},{default:l(()=>[t(i,{prop:"port",label:"端口",width:"100"}),t(i,{prop:"protocol",label:"协议",width:"80"},{default:l(({row:o})=>[t(x,{size:"small"},{default:l(()=>[_(p(o.protocol?.toUpperCase()),1)]),_:2},1024)]),_:1}),t(i,{prop:"address",label:"地址","min-width":"140"}),t(i,{prop:"process",label:"进程","min-width":"120"}),t(i,{prop:"pid",label:"PID",width:"100"}),t(i,{label:"操作",width:"150"},{default:l(({row:o})=>[t(C,{link:"",type:"primary",onClick:ie=>F(o.port)},{default:l(()=>[t(V,null,{default:l(()=>[t(L)]),_:1}),e[8]||(e[8]=_(" 详情 ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[$,f.value]])]),_:1}),t(M,{modelValue:k.value,"onUpdate:modelValue":e[2]||(e[2]=o=>k.value=o),title:"端口详情",width:"500px"},{default:l(()=>[c.value?(r(),u("div",Y,[a("div",Z,[e[9]||(e[9]=a("span",{class:"label"},"端口",-1)),a("span",ee,p(B.value),1)]),a("div",te,[e[10]||(e[10]=a("span",{class:"label"},"状态",-1)),t(x,{type:c.value.inUse?"danger":"success"},{default:l(()=>[_(p(c.value.inUse?"已占用":"空闲"),1)]),_:1},8,["type"])]),c.value.process?(r(),u("div",le,[e[11]||(e[11]=a("span",{class:"label"},"进程",-1)),a("span",ae,p(c.value.process),1)])):m("",!0),c.value.pid?(r(),u("div",oe,[e[12]||(e[12]=a("span",{class:"label"},"PID",-1)),a("span",se,p(c.value.pid),1)])):m("",!0)])):m("",!0),P.value.length?(r(),u("div",ne,[e[13]||(e[13]=a("h4",null,"活跃连接",-1)),t(S,{data:P.value,size:"small"},{default:l(()=>[t(i,{prop:"remoteAddr",label:"远程地址"}),t(i,{prop:"remotePort",label:"远程端口",width:"100"}),t(i,{prop:"state",label:"状态",width:"120"})]),_:1},8,["data"])])):m("",!0)]),_:1},8,["modelValue"])])}}},_e=j(re,[["__scopeId","data-v-43f304e6"]]);export{_e as default};
