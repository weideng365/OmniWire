import{p as w}from"./index-DdvxEg8k.js";import{o as T,a as d,c as r,b as e,d as s,w as t,e as v,r as u,B as X,h as f,U as Y,n as D,X as Z,C as m,y,t as o,Y as j,Z as q,_ as I,$ as H,G as J,a0 as K,a1 as O,F as Q,x as W,p as ee,R as z}from"./index-CXM0Czvl.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";const te={class:"port-page"},ae={class:"port-dashboard"},le={class:"scan-section"},oe={class:"card-title"},ne={class:"scan-wrapper"},de={class:"scan-inputs"},ie={class:"range-separator"},ce={key:0,class:"scan-status"},re={class:"scanning-text"},ue={key:1,class:"scan-results-area"},_e={class:"result-header"},pe={key:0,class:"result-count"},ve={key:1,class:"result-empty"},he={key:0,class:"result-tags"},fe=["onClick"],me={class:"tag-port"},ge={class:"tag-proto"},be={class:"list-section"},ke={class:"card-header"},we={class:"header-title"},ye={class:"port-badge"},Pe={class:"process-info"},xe={class:"pid-text"},Ce={class:"addr-text"},Ue={key:0,class:"detail-container"},Ve={class:"banner-icon"},De={class:"banner-content"},ze={class:"port-number"},Be={class:"port-status"},Ne={key:0,class:"detail-grid"},Re={class:"detail-box"},$e={class:"value process"},Ae={class:"detail-box"},Fe={class:"value pid"},Ie={class:"detail-box full"},Ee={class:"value addr"},Le={key:1,class:"connections-list"},Me={class:"list-title"},Se={class:"conn-addr"},Ge={__name:"Port",setup(Te){const b=u(!1),g=u(!1),P=u(!1),_=u({startPort:1,endPort:1024}),h=u([]),x=u([]),C=u(!1),B=u(0),i=u(null),k=u([]),E=async()=>{if(_.value.startPort>_.value.endPort){z.warning("起始端口不能大于结束端口");return}g.value=!0,P.value=!1,h.value=[];try{const n=await w.scan(_.value);h.value=n.data?.ports||[],P.value=!0,h.value.length>0?z.success(`扫描完成，发现 ${h.value.length} 个开放端口`):z.info("扫描完成，未发现开放端口")}catch(n){console.error(n)}g.value=!1},N=async()=>{b.value=!0;try{const n=await w.listen();x.value=n.data?.ports||[]}catch(n){console.error(n)}b.value=!1},R=async n=>{B.value=n,C.value=!0,i.value=null,k.value=[];try{const[l,c]=await Promise.all([w.check(n),w.connections(n)]);i.value=l.data||{port:n,inUse:!1},k.value=c.data?.connections||[]}catch(l){console.error(l),i.value={port:n,inUse:!1}}};return T(()=>{N()}),(n,l)=>{const c=v("el-icon"),$=v("el-input-number"),U=v("el-button"),L=v("el-progress"),A=v("el-card"),V=v("el-tag"),p=v("el-table-column"),F=v("el-table"),M=v("el-dialog"),S=X("loading");return d(),r("div",te,[l[8]||(l[8]=e("div",{class:"page-header"},[e("div",{class:"header-content"},[e("h1",null,"端口管理"),e("p",null,"扫描并分析服务器端口占用情况")]),e("div",{class:"header-actions"})],-1)),e("div",ae,[e("div",le,[s(A,{class:"scan-card"},{header:t(()=>[e("div",oe,[s(c,null,{default:t(()=>[s(f(H))]),_:1}),l[3]||(l[3]=e("span",null,"快速扫描",-1))])]),default:t(()=>[e("div",ne,[e("div",de,[s($,{modelValue:_.value.startPort,"onUpdate:modelValue":l[0]||(l[0]=a=>_.value.startPort=a),min:1,max:65535,placeholder:"起始","controls-position":"right",class:"port-input"},null,8,["modelValue"]),e("span",ie,[s(c,null,{default:t(()=>[s(f(Y))]),_:1})]),s($,{modelValue:_.value.endPort,"onUpdate:modelValue":l[1]||(l[1]=a=>_.value.endPort=a),min:1,max:65535,placeholder:"结束","controls-position":"right",class:"port-input"},null,8,["modelValue"])]),s(U,{type:"primary",size:"large",onClick:E,loading:g.value,class:"scan-btn"},{default:t(()=>[g.value?m("",!0):(d(),D(c,{key:0},{default:t(()=>[s(f(Z))]),_:1})),y(" "+o(g.value?"正在扫描...":"开始扫描"),1)]),_:1},8,["loading"])]),g.value?(d(),r("div",ce,[s(L,{percentage:100,status:"success",indeterminate:!0,duration:2,"stroke-width":4,"show-text":!1}),e("span",re,"正在扫描端口范围 "+o(_.value.startPort)+" - "+o(_.value.endPort)+"...",1)])):m("",!0),P.value?(d(),r("div",ue,[e("div",_e,[h.value.length>0?(d(),r("span",pe,"发现 "+o(h.value.length)+" 个开放端口",1)):(d(),r("span",ve,"未发现开放端口"))]),h.value.length>0?(d(),r("div",he,[(d(!0),r(j,null,q(h.value,a=>(d(),r("div",{key:a.port,class:"result-tag",onClick:G=>R(a.port)},[e("span",me,o(a.port),1),e("span",ge,o(a.protocol),1),s(c,{class:"arrow"},{default:t(()=>[s(f(I))]),_:1})],8,fe))),128))])):m("",!0)])):m("",!0)]),_:1})]),e("div",be,[s(A,{class:"list-card"},{header:t(()=>[e("div",ke,[e("div",we,[s(c,null,{default:t(()=>[s(f(O))]),_:1}),l[4]||(l[4]=e("span",null,"正在监听",-1)),s(V,{size:"small",effect:"plain",round:""},{default:t(()=>[y(o(x.value.length),1)]),_:1})]),s(U,{circle:"",onClick:N,loading:b.value,disabled:b.value},{default:t(()=>[s(c,null,{default:t(()=>[s(f(Q))]),_:1})]),_:1},8,["loading","disabled"])])]),default:t(()=>[J((d(),D(F,{data:x.value,style:{width:"100%"},"row-style":{height:"56px"}},{default:t(()=>[s(p,{prop:"port",label:"端口",width:"90",align:"center"},{default:t(({row:a})=>[e("span",ye,o(a.port),1)]),_:1}),s(p,{prop:"protocol",label:"协议",width:"80",align:"center"},{default:t(({row:a})=>[s(V,{size:"small",effect:"light",type:a.protocol==="tcp"?"":"warning"},{default:t(()=>[y(o(a.protocol?.toUpperCase()),1)]),_:2},1032,["type"])]),_:1}),s(p,{prop:"process",label:"进程服务","min-width":"140"},{default:t(({row:a})=>[e("div",Pe,[s(c,null,{default:t(()=>[s(f(K))]),_:1}),e("span",null,o(a.process||"Unknown"),1)])]),_:1}),s(p,{prop:"pid",label:"PID",width:"80",align:"center"},{default:t(({row:a})=>[e("span",xe,o(a.pid||"-"),1)]),_:1}),s(p,{label:"地址绑定","min-width":"140"},{default:t(({row:a})=>[e("code",Ce,o(a.address),1)]),_:1}),s(p,{width:"60",align:"center"},{default:t(({row:a})=>[s(U,{circle:"",size:"small",onClick:G=>R(a.port)},{default:t(()=>[s(c,null,{default:t(()=>[s(f(I))]),_:1})]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[S,b.value]])]),_:1})])]),s(M,{modelValue:C.value,"onUpdate:modelValue":l[2]||(l[2]=a=>C.value=a),title:"端口详情分析",width:"600px",center:"","destroy-on-close":""},{default:t(()=>[i.value?(d(),r("div",Ue,[e("div",{class:W(["port-header-banner",{active:i.value.inUse}])},[e("div",Ve,[s(c,null,{default:t(()=>[(d(),D(ee(i.value.inUse?"CircleCheck":"CircleClose")))]),_:1})]),e("div",De,[e("div",ze,"Port "+o(B.value),1),e("div",Be,o(i.value.inUse?"端口正在被使用":"端口空闲"),1)])],2),i.value.inUse?(d(),r("div",Ne,[e("div",Re,[l[5]||(l[5]=e("div",{class:"label"},"进程名称",-1)),e("div",$e,o(i.value.process||"Unknown"),1)]),e("div",Ae,[l[6]||(l[6]=e("div",{class:"label"},"进程 PID",-1)),e("div",Fe,o(i.value.pid||"-"),1)]),e("div",Ie,[l[7]||(l[7]=e("div",{class:"label"},"监听地址",-1)),e("div",Ee,o(i.value.address||"0.0.0.0"),1)])])):m("",!0),k.value.length?(d(),r("div",Le,[e("div",Me,"活跃连接 ("+o(k.value.length)+")",1),s(F,{data:k.value,size:"small","max-height":"200px"},{default:t(()=>[s(p,{prop:"remoteAddr",label:"远程地址","min-width":"140"},{default:t(({row:a})=>[e("code",Se,o(a.remoteAddr),1)]),_:1}),s(p,{prop:"remotePort",label:"端口",width:"80"}),s(p,{prop:"state",label:"状态",width:"100"},{default:t(({row:a})=>[s(V,{size:"small",effect:"plain"},{default:t(()=>[y(o(a.state),1)]),_:2},1024)]),_:1})]),_:1},8,["data"])])):m("",!0)])):m("",!0)]),_:1},8,["modelValue"])])}}},je=se(Ge,[["__scopeId","data-v-17b1bf09"]]);export{je as default};
